<!DOCTYPE html>
<html lang="zh">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Ali云服务器配置 | 晨钟暮鼓</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="noodp" />
<meta name="Description" content="Gavin&#39;s Blog"><link rel="prev" href="https://47.105.127.66/2020/02/0002-hugo-concise-tutorial2/" /><link rel="next" href="https://47.105.127.66/2020/02/0004-ssh-introduction/" /><link rel="canonical" href="https://47.105.127.66/2020/02/0003-ali-cloud-server/" />
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff"><meta property="og:title" content="Ali云服务器配置" />
<meta property="og:description" content="阿里云ECS服务器配置
趁着过年期间阿里云的新客活动，忍痛购买了3年的ECS云服务器，顺便可以给自己的域名挂上良民证，奥利给！
但是由于今年疫情的原因，备案时间会比较长，据说需要20天左右。而且之前一直只是在用Linux Client，于是趁着备案期间先熟悉一下阿里云Linux Server的使用和设置，下面是一些零零散散的~踩坑~学习记录。
密码
管理密码是一件非常头疼的事情，每次设置完密码都会陷入沉思，&ldquo;woc&hellip;马什么梅来?&quot;。
ECS实例创建后主要使用的有两个密码，分别是实例密码和远程连接密码。

实例密码
实例密码是Linux操作系统的密码，就是Root用户密码。奇怪的是创建实例时没有任何初始密码的提示，我是在创建完成后在服务控制台进行的密码重置，需要注意的是重置密码需要重启实例后才会生效。
远程连接密码
远程连接密码是指阿里云控制台自带的远程连接工具的密码，这个密码最初是系统自动生成的6位数字，用户可以自定义修改这个远程连接密码。

事实上，如果我们不使用阿里云控制台自带的VNC远程连接工具，那么就用不到远程连接密码。更改远程连接密码无需重启直接生效；实例密码是Linux系统下的root密码，Windows系统下的administrator密码，修改实例密码必须重启实例才可以生效。
网络
阿里云面向客户提供的网络类型服务有经典网络和专有网络两种，官方文档给的解释是：

经典网络
ip地址由阿里云统一分配，配置简便，使用方便，适合对操作易用性要求比较高、需要快速使用 ECS 的用户。
专有网络
是指逻辑隔离的私有网络，您可以自定义网络拓扑和 ip 地址，支持通过专线连接。适合于熟悉网络管理的用户。

我们通俗点理解就是，经典网络和专有网络公网使用同一个公网ip。但是从内网ip来看，经典网络是DHIP，也就是系统自动分配局域网ip地址，而专有网络则是手动分配局域网ip地址，方便有多台云服务器的用户自行定义内网ip结构。所以，如果我们只有一台服务器，或者有多台服务器但不需要进行内网互联，那么这两种网络任选一个就可以了。
带宽

入网带宽（上行带宽）
流入云服务器ECS的带宽，例如：

云服务器ECS下载外部网络资源
FTP客户端上传资源到云服务器ECS


出网带宽（下行带宽）
流出云服务器ECS的带宽，例如：

云服务器ECS对外提供访问
FTP客户端下载云服务器ECS内部资源



安全组
安全组是ECS实例的虚拟防火墙，用于设置实例的网络访问控制，允许或拒绝公网请求和内网请求。
安全组具备状态检测和数据包过滤功能，可以设置单台或多台云服务器的网络访问控制。
每个实例必须属于至少一个安全组，一个安全组可以包括多个实例。同一安全组内的实例之间默认内网互通，不同安全组的实例之间默认内网不通，可以授权两个安全组之间互访。
在创建实例时，系统会提供一个默认安全组，默认安全组中的默认规则仅设置针对ICMP协议、SSH 22端口、RDP 3389端口、HTTP 80端口和HTTPS 443端口的入方向规则。
我们也可以自行创建一个安全组并添加能满足自己业务需求的安全组规则，自行创建的安全组在未添加任何安全组规则之前，出方向允许所有访问，入方向拒绝所有访问。
添加安全组规则
一般场景下我们需要设置的选项主要有两个：端口范围和授权对象，其他可参考默认设置。

端口范围
端口取值范围从1到65535，设置格式例如1/200或者80/80，其中“-1/-1”不能单独设置，代表不限制端口。
授权对象
可以填写单个ip地址，例如223.78.253.196/32，填写0.0.0.0/0表示允许/拒绝全网段访问指定端口。
可以填写多个ip地址，彼此之间用逗号隔开。
此外还可以指定ip地址段，如 223.78.253.196/31，这将会授权/拒绝223.78.253.196和223.78.253.197的连接。

规则优先级
同类型规则间依赖优先级（手动建立1-100，系统建立110）决定最终执行的规则。当ECS实例加入了多个安全组时，多个安全组会从高到低依次匹配规则。优先级取值范围如下所示，数值越小，优先级越高。
实践建议

仅允许少量请求访问ECS实例时，可以将安全组作为白名单使用。即先设置安全组为拒绝全部访问，然后逐一添加允许通信的访问请求策略。
选择开放具体的端口，如80/80端口，不要设置为端口范围。
添加安全组规则时，谨慎授权0.0.0.0/0（全网段）访问源。

案例
如果您在实例上架设了一个网站，希望您的用户能通过HTTPS服务访问到您的网站，您需要在实例所在安全组中添加以下安全组规则。



网络类型
网卡类型
规则方向
授权策略
协议类型
端口范围
授权类型
授权对象
优先级




VPC
不需要配置
入方向
允许
HTTPS
443
地址段访问
0.0.0.0/0
1


经典网络
公网
入方向
允许
HTTPS
443
地址段访问
0.0.0.0/0
1



SSH连接实例
Secure Shell（SSH）是一种加密网络协议，通过对传输内容进行加密在不安全的网络上安全地操作网络服务，常用于用户远程登录到计算机系统。
SSH不是本文介绍的重点，详细请看这篇文章，本文主要介绍阿里云SSH配置。
Root用户
首先，我们需要在安全组中开放入方向的22端口（默认已经开启），确认开启之后我们可以通过用户名密码验证和SSH密钥对验证两种方式远程连接服务器实例。密钥验证相对更加安全，而且阿里云的SSH密钥设置也非常简便，直接在控制台中即可完成。
首先我们在 云服务控制台 &gt; 网络与安全 &gt; 密钥对 中创建密钥对并绑定实例，该密钥由ECS生成，默认采用RSA 2048位的加密方式。密钥绑定后，公钥会自动保存在实例中，我们把私钥保存到本地，然后便可通过Xshell等工具连接实例了。
非Root用户
实践注意事项
使用SSH密钥需要注意两点：

如果使用SSH密钥对登录Linux实例，将会禁用密码登录，以提高安全性。
如果在绑定密钥对之后想使用密码方式登录实例，可以通过重置实例密码实现。如果在绑定密钥对之后重置了实例密码，使用密钥对方式和使用密码方式均能登录实例。
基于数据安全考虑，在实例状态为运行中（Running）时绑定或者解绑密钥对，您需要重启实例使操作生效。
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://47.105.127.66/2020/02/0003-ali-cloud-server/" />
<meta property="article:published_time" content="2020-02-12T19:48:57+08:00" />
<meta property="article:modified_time" content="2020-02-12T19:48:57+08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Ali云服务器配置"/>
<meta name="twitter:description" content="阿里云ECS服务器配置
趁着过年期间阿里云的新客活动，忍痛购买了3年的ECS云服务器，顺便可以给自己的域名挂上良民证，奥利给！
但是由于今年疫情的原因，备案时间会比较长，据说需要20天左右。而且之前一直只是在用Linux Client，于是趁着备案期间先熟悉一下阿里云Linux Server的使用和设置，下面是一些零零散散的~踩坑~学习记录。
密码
管理密码是一件非常头疼的事情，每次设置完密码都会陷入沉思，&ldquo;woc&hellip;马什么梅来?&quot;。
ECS实例创建后主要使用的有两个密码，分别是实例密码和远程连接密码。

实例密码
实例密码是Linux操作系统的密码，就是Root用户密码。奇怪的是创建实例时没有任何初始密码的提示，我是在创建完成后在服务控制台进行的密码重置，需要注意的是重置密码需要重启实例后才会生效。
远程连接密码
远程连接密码是指阿里云控制台自带的远程连接工具的密码，这个密码最初是系统自动生成的6位数字，用户可以自定义修改这个远程连接密码。

事实上，如果我们不使用阿里云控制台自带的VNC远程连接工具，那么就用不到远程连接密码。更改远程连接密码无需重启直接生效；实例密码是Linux系统下的root密码，Windows系统下的administrator密码，修改实例密码必须重启实例才可以生效。
网络
阿里云面向客户提供的网络类型服务有经典网络和专有网络两种，官方文档给的解释是：

经典网络
ip地址由阿里云统一分配，配置简便，使用方便，适合对操作易用性要求比较高、需要快速使用 ECS 的用户。
专有网络
是指逻辑隔离的私有网络，您可以自定义网络拓扑和 ip 地址，支持通过专线连接。适合于熟悉网络管理的用户。

我们通俗点理解就是，经典网络和专有网络公网使用同一个公网ip。但是从内网ip来看，经典网络是DHIP，也就是系统自动分配局域网ip地址，而专有网络则是手动分配局域网ip地址，方便有多台云服务器的用户自行定义内网ip结构。所以，如果我们只有一台服务器，或者有多台服务器但不需要进行内网互联，那么这两种网络任选一个就可以了。
带宽

入网带宽（上行带宽）
流入云服务器ECS的带宽，例如：

云服务器ECS下载外部网络资源
FTP客户端上传资源到云服务器ECS


出网带宽（下行带宽）
流出云服务器ECS的带宽，例如：

云服务器ECS对外提供访问
FTP客户端下载云服务器ECS内部资源



安全组
安全组是ECS实例的虚拟防火墙，用于设置实例的网络访问控制，允许或拒绝公网请求和内网请求。
安全组具备状态检测和数据包过滤功能，可以设置单台或多台云服务器的网络访问控制。
每个实例必须属于至少一个安全组，一个安全组可以包括多个实例。同一安全组内的实例之间默认内网互通，不同安全组的实例之间默认内网不通，可以授权两个安全组之间互访。
在创建实例时，系统会提供一个默认安全组，默认安全组中的默认规则仅设置针对ICMP协议、SSH 22端口、RDP 3389端口、HTTP 80端口和HTTPS 443端口的入方向规则。
我们也可以自行创建一个安全组并添加能满足自己业务需求的安全组规则，自行创建的安全组在未添加任何安全组规则之前，出方向允许所有访问，入方向拒绝所有访问。
添加安全组规则
一般场景下我们需要设置的选项主要有两个：端口范围和授权对象，其他可参考默认设置。

端口范围
端口取值范围从1到65535，设置格式例如1/200或者80/80，其中“-1/-1”不能单独设置，代表不限制端口。
授权对象
可以填写单个ip地址，例如223.78.253.196/32，填写0.0.0.0/0表示允许/拒绝全网段访问指定端口。
可以填写多个ip地址，彼此之间用逗号隔开。
此外还可以指定ip地址段，如 223.78.253.196/31，这将会授权/拒绝223.78.253.196和223.78.253.197的连接。

规则优先级
同类型规则间依赖优先级（手动建立1-100，系统建立110）决定最终执行的规则。当ECS实例加入了多个安全组时，多个安全组会从高到低依次匹配规则。优先级取值范围如下所示，数值越小，优先级越高。
实践建议

仅允许少量请求访问ECS实例时，可以将安全组作为白名单使用。即先设置安全组为拒绝全部访问，然后逐一添加允许通信的访问请求策略。
选择开放具体的端口，如80/80端口，不要设置为端口范围。
添加安全组规则时，谨慎授权0.0.0.0/0（全网段）访问源。

案例
如果您在实例上架设了一个网站，希望您的用户能通过HTTPS服务访问到您的网站，您需要在实例所在安全组中添加以下安全组规则。



网络类型
网卡类型
规则方向
授权策略
协议类型
端口范围
授权类型
授权对象
优先级




VPC
不需要配置
入方向
允许
HTTPS
443
地址段访问
0.0.0.0/0
1


经典网络
公网
入方向
允许
HTTPS
443
地址段访问
0.0.0.0/0
1



SSH连接实例
Secure Shell（SSH）是一种加密网络协议，通过对传输内容进行加密在不安全的网络上安全地操作网络服务，常用于用户远程登录到计算机系统。
SSH不是本文介绍的重点，详细请看这篇文章，本文主要介绍阿里云SSH配置。
Root用户
首先，我们需要在安全组中开放入方向的22端口（默认已经开启），确认开启之后我们可以通过用户名密码验证和SSH密钥对验证两种方式远程连接服务器实例。密钥验证相对更加安全，而且阿里云的SSH密钥设置也非常简便，直接在控制台中即可完成。
首先我们在 云服务控制台 &gt; 网络与安全 &gt; 密钥对 中创建密钥对并绑定实例，该密钥由ECS生成，默认采用RSA 2048位的加密方式。密钥绑定后，公钥会自动保存在实例中，我们把私钥保存到本地，然后便可通过Xshell等工具连接实例了。
非Root用户
实践注意事项
使用SSH密钥需要注意两点：

如果使用SSH密钥对登录Linux实例，将会禁用密码登录，以提高安全性。
如果在绑定密钥对之后想使用密码方式登录实例，可以通过重置实例密码实现。如果在绑定密钥对之后重置了实例密码，使用密钥对方式和使用密码方式均能登录实例。
基于数据安全考虑，在实例状态为运行中（Running）时绑定或者解绑密钥对，您需要重启实例使操作生效。
"/>
<script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Ali云服务器配置",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/47.105.127.66\/2020\/02\/0003-ali-cloud-server\/"
        },"image": {
                "@type": "ImageObject",
                "url": "https:\/\/47.105.127.66\/cover.png",
                "width":  800 ,
                "height":  600 
            },"genre": "posts","keywords": "Server, Ubuntu","wordcount":  2473 ,
        "url": "https:\/\/47.105.127.66\/2020\/02\/0003-ali-cloud-server\/","datePublished": "2020-02-12T19:48:57\x2b08:00","dateModified": "2020-02-12T19:48:57\x2b08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
                "@type": "Organization",
                "name": "Gavin",
                "logo": {
                "@type": "ImageObject",
                "url": "https:\/\/47.105.127.66\/logo.png",
                "width":  127 ,
                "height":  40 
                }
            },"description": ""
    }
    </script><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/css/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/css/lib/animate/animate.min.css"></head>
    <body><script>
            window.isDark = (window.localStorage && window.localStorage.getItem('theme')) === 'dark';
            window.isDark && document.body.classList.add('dark-theme');
        </script><div class="wrapper"><nav class="navbar">
    <div class="navbar-container">
        <div class="navbar-header animated bounceIn">
            <a href="https://47.105.127.66/">晨钟暮鼓</a>
        </div>
        <div class="navbar-menu"><a class="menu-item" href="https://47.105.127.66/posts" title="">文章</a><a class="menu-item" href="https://47.105.127.66/tags" title="">标签</a><a class="menu-item" href="https://47.105.127.66/categories" title="">分类</a><a class="menu-item" href="https://47.105.127.66/about" title="">关于</a><a class="menu-item" href="https://47.105.127.66/" title="English">主页</a><a href="javascript:void(0);" class="theme-switch"><i class="fas fa-adjust fa-rotate-180 fa-fw" title="切换主题"></i></a>
        </div>
    </div>
</nav><nav class="navbar-mobile">
    <div class="navbar-container">
        <div class="navbar-header">
            <div class="navbar-header-title animated bounceIn">
                <a href="https://47.105.127.66/">晨钟暮鼓</a>
            </div>
            <div class="menu-toggle" id="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="navbar-menu" id="mobile-menu"><a class="menu-item" href="https://47.105.127.66/posts" title="">文章</a><a class="menu-item" href="https://47.105.127.66/tags" title="">标签</a><a class="menu-item" href="https://47.105.127.66/categories" title="">分类</a><a class="menu-item" href="https://47.105.127.66/about" title="">关于</a><a class="menu-item" href="https://47.105.127.66/" title="English">主页</a><a href="javascript:void(0);" class="theme-switch"><i class="fas fa-adjust fa-rotate-180 fa-fw" title="切换主题"></i></a>
        </div>
    </div>
</nav><main class="main">
                <div class="container"><article class="page"><h1 class="post-title animated flipInX">Ali云服务器配置</h1><div class="post-meta">
            <div class="post-meta-main"><a class="author" href="https://47.105.127.66/" rel="author" target="_blank">
                    <i class="fas fa-user-circle fa-fw"></i>Gavin
                </a>&nbsp;<span class="post-category">收录于&nbsp;<i class="far fa-folder fa-fw"></i><a href="https://47.105.127.66/categories/server/">Server</a>&nbsp;</span></div>
            <div class="post-meta-other"><i class="far fa-calendar-alt fa-fw"></i><time datetime=0001-01-01>0001-01-01</time>&nbsp;
                <i class="fas fa-pencil-alt fa-fw"></i>约 2473 字&nbsp;
                <i class="far fa-clock fa-fw"></i>预计阅读 5 分钟&nbsp;<span id="/2020/02/0003-ali-cloud-server/" class="leancloud_visitors" data-flag-title="Ali云服务器配置">
                        <i class="far fa-eye fa-fw"></i><span class=leancloud-visitors-count></span> 次阅读
                    </span>&nbsp;</div>
        </div><div class="post-toc" id="post-toc">
                <h2 class="post-toc-title">目录</h2>
                <div class="post-toc-content"><nav id="TableOfContents">
  <ul>
    <li><a href="#阿里云ecs服务器配置">阿里云ECS服务器配置</a>
      <ul>
        <li><a href="#密码">密码</a></li>
      </ul>
    </li>
    <li><a href="#网络">网络</a></li>
    <li><a href="#带宽">带宽</a></li>
    <li><a href="#安全组">安全组</a>
      <ul>
        <li><a href="#添加安全组规则">添加安全组规则</a></li>
        <li><a href="#规则优先级">规则优先级</a></li>
        <li><a href="#实践建议">实践建议</a></li>
        <li><a href="#案例">案例</a></li>
      </ul>
    </li>
    <li><a href="#ssh连接实例">SSH连接实例</a>
      <ul>
        <li><a href="#root用户">Root用户</a></li>
        <li><a href="#非root用户">非Root用户</a></li>
        <li><a href="#实践注意事项">实践注意事项</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div>
            <div class="post-toc-mobile" id="post-toc-mobile">
                <details>
                    <summary>
                        <div class="post-toc-title">
                            <span>目录</span>
                            <span><i class="details icon fas fa-angle-down"></i></span>
                        </div>
                    </summary>
                    <div class="post-toc-content"><nav id="TableOfContentsMobile">
  <ul>
    <li><a href="#阿里云ecs服务器配置">阿里云ECS服务器配置</a>
      <ul>
        <li><a href="#密码">密码</a></li>
      </ul>
    </li>
    <li><a href="#网络">网络</a></li>
    <li><a href="#带宽">带宽</a></li>
    <li><a href="#安全组">安全组</a>
      <ul>
        <li><a href="#添加安全组规则">添加安全组规则</a></li>
        <li><a href="#规则优先级">规则优先级</a></li>
        <li><a href="#实践建议">实践建议</a></li>
        <li><a href="#案例">案例</a></li>
      </ul>
    </li>
    <li><a href="#ssh连接实例">SSH连接实例</a>
      <ul>
        <li><a href="#root用户">Root用户</a></li>
        <li><a href="#非root用户">非Root用户</a></li>
        <li><a href="#实践注意事项">实践注意事项</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
                </details>
            </div><div class="post-content"><a class="post-dummy-target" id="阿里云ecs服务器配置"></a><h2>阿里云ECS服务器配置</h2>
<p>趁着过年期间阿里云的新客活动，忍痛购买了3年的ECS云服务器，顺便可以给自己的域名挂上良民证，奥利给！</p>
<p>但是由于今年疫情的原因，备案时间会比较长，据说需要20天左右。而且之前一直只是在用Linux Client，于是趁着备案期间先熟悉一下阿里云Linux Server的使用和设置，下面是一些零零散散的~踩坑~学习记录。</p>
<a class="post-dummy-target" id="密码"></a><h3>密码</h3>
<p>管理密码是一件非常头疼的事情，每次设置完密码都会陷入沉思，&ldquo;woc&hellip;马什么梅来?&quot;。<br>
ECS实例创建后主要使用的有两个密码，分别是实例密码和远程连接密码。</p>
<ul>
<li>实例密码<br>
实例密码是Linux操作系统的密码，就是Root用户密码。奇怪的是创建实例时没有任何初始密码的提示，我是在创建完成后在服务控制台进行的密码重置，需要注意的是重置密码需要重启实例后才会生效。</li>
<li>远程连接密码<br>
远程连接密码是指阿里云控制台自带的远程连接工具的密码，这个密码最初是系统自动生成的6位数字，用户可以自定义修改这个远程连接密码。</li>
</ul>
<p>事实上，如果我们不使用阿里云控制台自带的VNC远程连接工具，那么就用不到远程连接密码。更改远程连接密码无需重启直接生效；实例密码是Linux系统下的root密码，Windows系统下的administrator密码，修改实例密码必须重启实例才可以生效。</p>
<a class="post-dummy-target" id="网络"></a><h2>网络</h2>
<p>阿里云面向客户提供的网络类型服务有经典网络和专有网络两种，官方文档给的解释是：</p>
<ul>
<li>经典网络<br>
ip地址由阿里云统一分配，配置简便，使用方便，适合对操作易用性要求比较高、需要快速使用 ECS 的用户。</li>
<li>专有网络<br>
是指逻辑隔离的私有网络，您可以自定义网络拓扑和 ip 地址，支持通过专线连接。适合于熟悉网络管理的用户。</li>
</ul>
<p>我们通俗点理解就是，经典网络和专有网络公网使用同一个公网ip。但是从内网ip来看，经典网络是DHIP，也就是系统自动分配局域网ip地址，而专有网络则是手动分配局域网ip地址，方便有多台云服务器的用户自行定义内网ip结构。所以，如果我们只有一台服务器，或者有多台服务器但不需要进行内网互联，那么这两种网络任选一个就可以了。</p>
<a class="post-dummy-target" id="带宽"></a><h2>带宽</h2>
<ul>
<li>入网带宽（上行带宽）<br>
流入云服务器ECS的带宽，例如：
<ul>
<li>云服务器ECS下载外部网络资源</li>
<li>FTP客户端上传资源到云服务器ECS</li>
</ul>
</li>
<li>出网带宽（下行带宽）<br>
流出云服务器ECS的带宽，例如：
<ul>
<li>云服务器ECS对外提供访问</li>
<li>FTP客户端下载云服务器ECS内部资源</li>
</ul>
</li>
</ul>
<a class="post-dummy-target" id="安全组"></a><h2>安全组</h2>
<p>安全组是ECS实例的虚拟防火墙，用于设置实例的网络访问控制，允许或拒绝公网请求和内网请求。<br>
安全组具备状态检测和数据包过滤功能，可以设置单台或多台云服务器的网络访问控制。<br>
每个实例必须属于至少一个安全组，一个安全组可以包括多个实例。同一安全组内的实例之间默认内网互通，不同安全组的实例之间默认内网不通，可以授权两个安全组之间互访。<br>
在创建实例时，系统会提供一个默认安全组，默认安全组中的默认规则仅设置针对ICMP协议、SSH 22端口、RDP 3389端口、HTTP 80端口和HTTPS 443端口的入方向规则。<br>
我们也可以自行创建一个安全组并添加能满足自己业务需求的安全组规则，自行创建的安全组在未添加任何安全组规则之前，出方向允许所有访问，入方向拒绝所有访问。</p>
<a class="post-dummy-target" id="添加安全组规则"></a><h3>添加安全组规则</h3>
<p>一般场景下我们需要设置的选项主要有两个：端口范围和授权对象，其他可参考默认设置。</p>
<ul>
<li>端口范围<br>
端口取值范围从1到65535，设置格式例如1/200或者80/80，其中“-1/-1”不能单独设置，代表不限制端口。</li>
<li>授权对象<br>
可以填写单个ip地址，例如223.78.253.196/32，填写0.0.0.0/0表示允许/拒绝全网段访问指定端口。<br>
可以填写多个ip地址，彼此之间用逗号隔开。<br>
此外还可以指定ip地址段，如 223.78.253.196/31，这将会授权/拒绝223.78.253.196和223.78.253.197的连接。</li>
</ul>
<a class="post-dummy-target" id="规则优先级"></a><h3>规则优先级</h3>
<p>同类型规则间依赖优先级（手动建立1-100，系统建立110）决定最终执行的规则。当ECS实例加入了多个安全组时，多个安全组会从高到低依次匹配规则。优先级取值范围如下所示，数值越小，优先级越高。</p>
<a class="post-dummy-target" id="实践建议"></a><h3>实践建议</h3>
<ul>
<li>仅允许少量请求访问ECS实例时，可以将安全组作为白名单使用。即先设置安全组为拒绝全部访问，然后逐一添加允许通信的访问请求策略。</li>
<li>选择开放具体的端口，如80/80端口，不要设置为端口范围。</li>
<li>添加安全组规则时，谨慎授权0.0.0.0/0（全网段）访问源。</li>
</ul>
<a class="post-dummy-target" id="案例"></a><h3>案例</h3>
<p>如果您在实例上架设了一个网站，希望您的用户能通过HTTPS服务访问到您的网站，您需要在实例所在安全组中添加以下安全组规则。</p>
<table>
<thead>
<tr>
<th align="center">网络类型</th>
<th align="center">网卡类型</th>
<th align="center">规则方向</th>
<th align="center">授权策略</th>
<th align="center">协议类型</th>
<th align="center">端口范围</th>
<th align="center">授权类型</th>
<th align="center">授权对象</th>
<th align="center">优先级</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VPC</td>
<td align="center">不需要配置</td>
<td align="center">入方向</td>
<td align="center">允许</td>
<td align="center">HTTPS</td>
<td align="center">443</td>
<td align="center">地址段访问</td>
<td align="center">0.0.0.0/0</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">经典网络</td>
<td align="center">公网</td>
<td align="center">入方向</td>
<td align="center">允许</td>
<td align="center">HTTPS</td>
<td align="center">443</td>
<td align="center">地址段访问</td>
<td align="center">0.0.0.0/0</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<a class="post-dummy-target" id="ssh连接实例"></a><h2>SSH连接实例</h2>
<p>Secure Shell（SSH）是一种加密网络协议，通过对传输内容进行加密在不安全的网络上安全地操作网络服务，常用于用户远程登录到计算机系统。<br>
SSH不是本文介绍的重点，详细请看这篇<a href="daibuchong">文章</a>，本文主要介绍阿里云SSH配置。</p>
<a class="post-dummy-target" id="root用户"></a><h3>Root用户</h3>
<p>首先，我们需要在安全组中开放入方向的22端口（默认已经开启），确认开启之后我们可以通过用户名密码验证和SSH密钥对验证两种方式远程连接服务器实例。密钥验证相对更加安全，而且阿里云的SSH密钥设置也非常简便，直接在控制台中即可完成。<br>
首先我们在 <code>云服务控制台 &gt; 网络与安全 &gt; 密钥对</code> 中创建密钥对并绑定实例，该密钥由ECS生成，默认采用RSA 2048位的加密方式。密钥绑定后，公钥会自动保存在实例中，我们把私钥保存到本地，然后便可通过Xshell等工具连接实例了。</p>
<a class="post-dummy-target" id="非root用户"></a><h3>非Root用户</h3>
<a class="post-dummy-target" id="实践注意事项"></a><h3>实践注意事项</h3>
<p>使用SSH密钥需要注意两点：</p>
<ul>
<li>如果使用SSH密钥对登录Linux实例，将会禁用密码登录，以提高安全性。<br>
如果在绑定密钥对之后想使用密码方式登录实例，可以通过重置实例密码实现。如果在绑定密钥对之后重置了实例密码，使用密钥对方式和使用密码方式均能登录实例。</li>
<li>基于数据安全考虑，在实例状态为运行中（Running）时绑定或者解绑密钥对，您需要重启实例使操作生效。</li>
</ul></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>本文于 2020-02-12 更新</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share"><span><a href="//twitter.com/share?url=https%3a%2f%2f47.105.127.66%2f2020%2f02%2f0003-ali-cloud-server%2f&amp;text=Ali%e4%ba%91%e6%9c%8d%e5%8a%a1%e5%99%a8%e9%85%8d%e7%bd%ae&amp;via=" target="_blank" title="分享到 Twitter">
            <i class="fab fa-twitter fa-fw"></i>
        </a><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2f47.105.127.66%2f2020%2f02%2f0003-ali-cloud-server%2f" target="_blank" title="分享到 Facebook">
            <i class="fab fa-facebook-square fa-fw"></i>
        </a><a href="//reddit.com/submit?url=https%3a%2f%2f47.105.127.66%2f2020%2f02%2f0003-ali-cloud-server%2f&amp;title=Ali%e4%ba%91%e6%9c%8d%e5%8a%a1%e5%99%a8%e9%85%8d%e7%bd%ae" target="_blank" title="分享到 Reddit">
            <i class="fab fa-reddit fa-fw"></i>
        </a></span></div>
        </div>
    </div>

    <div class="post-info-more">
        <section><span class="tag">
                        <a href="https://47.105.127.66/tags/server/"><i class="fas fa-tag fa-fw"></i>&nbsp;Server</a>&nbsp;
                    </span><span class="tag">
                        <a href="https://47.105.127.66/tags/ubuntu/"><i class="fas fa-tag fa-fw"></i>&nbsp;Ubuntu</a>&nbsp;
                    </span></section>
        <section>
            <span><a href="javascript:window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="https://47.105.127.66/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="https://47.105.127.66/2020/02/0002-hugo-concise-tutorial2/" class="prev" rel="prev" title="Hugo简明教程2"><i class="fas fa-angle-left fa-fw"></i>Hugo简明教程2</a>
            <a href="https://47.105.127.66/2020/02/0004-ssh-introduction/" class="next" rel="next" title="SSH简介">SSH简介<i class="fas fa-angle-right fa-fw"></i></a></div>
</div><div class="post-comment"><div id="vcomments"></div><script src="/js/lib/valine/Valine.min.min.js"></script><script type="text/javascript">
            (function () {
                
                
                if (window.location.hostname == "localhost")
                    return;
                new Valine({
                    el: "#vcomments",
                    appId: "wi2zHvTM3ahn6m8dCA1YUV0u-gzGzoHsz",
                    appKey: "IotWRV7YPP7EeVVFGMicGR0S",
                    meta: ["nick", "mail"],
                    notify: "false",
                    verify: "true",
                    avatar: "mp",
                    placeholder: "你的评论 ...",
                    visitor: "true",
                    recordIP: "true",
                    lang: "zh-cn",
                });
            })();
        </script></div>
    </article></div>
            </main><footer class="footer">
    <div class="copyright"><div class="copyright-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2020</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://47.105.127.66/" target="_blank">Gavin</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span><span class="icp-splitter">&nbsp;|&nbsp;</span><br class="icp-br"/>
                <span class="icp"><a href="http://www.beian.miit.gov.cn" target="_blank">鲁ICP备20005030-1</a></span><span class="copyright-line">
				&nbsp;|&nbsp;Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreffer">Hugo</a> & <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="external nofollow noopener noreffer">LoveIt</a>
			</span>
		</div>
    </div>
</footer></div><a href="#" class="dynamic-to-top" id="dynamic-to-top" data-scroll>
            <span>&nbsp;</span>
        </a><script src="/js/lib/jquery/jquery.slim.min.js"></script><script src="/js/lib/lazysizes/lazysizes.min.js"></script><script src="/js/lib/smooth-scroll/smooth-scroll.polyfills.min.js"></script><script>window.scroll = new SmoothScroll('[data-scroll]', {speed: 300, speedAsDuration: true});</script><script src="/js/blog.min.js"></script></body>
</html>